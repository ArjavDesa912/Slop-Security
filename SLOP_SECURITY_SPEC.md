<p align="center">
  <img src="./assets/mascot and title.png" alt="Slop Security - Zero-Cognitive-Load Security" width="500"/>
</p>

# ğŸ›¡ï¸ Slop Security Specification

> **One line to secure, zero lines to worry.**

[![OWASP Top 10](https://img.shields.io/badge/OWASP-Top%2010%20Protected-brightgreen)](https://owasp.org/www-project-top-ten/)
[![Vibecoder Approved](https://img.shields.io/badge/Vibecoder-Approved%20âœ¨-purple)]()
[![Zero Config](https://img.shields.io/badge/Config-Zero%20Cognitive%20Load-blue)]()

---

## ğŸ“– Table of Contents

1. [The Slop Philosophy](#-the-slop-philosophy)
2. [AI-First Design](#-ai-first-design)
3. [OWASP Core Integration](#-owasp-core-integration)
4. [The Universal Engine](#-the-universal-engine)
5. [The Slop Manifest (slop.json)](#-the-slop-manifest-slopjson)
6. [Language SDK Blueprints](#-language-sdk-blueprints)
7. [The "Vibe-Check" CLI](#-the-vibe-check-cli)
8. [System Instructions Snippet](#-system-instructions-snippet)
9. [Architecture Diagrams](#-architecture-diagrams)
10. [Contributing](#-contributing)

---

## ğŸ§˜ The Slop Philosophy

### Zero-Cognitive-Load Principle

Vibecoders move fast. They build apps at lightning speed, shipping MVPs before coffee gets cold. Security? That's someone else's problem... until it isn't.

**Slop Security** is built on one core belief:

> *Security shouldn't require a PhD. It should require one line of code.*

#### The Three Pillars of Slop

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THE SLOP TRINITY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸ§  ZERO COGNITIVE LOAD     â†’  No config, no documentation,   â”‚
â”‚                                  no decisions required          â”‚
â”‚                                                                 â”‚
â”‚   âš¡ INSTANT INTEGRATION     â†’  One import, one function call, â”‚
â”‚                                  infinite protection            â”‚
â”‚                                                                 â”‚
â”‚   ğŸ¤– AI-NATIVE DESIGN        â†’  Built FOR AI-generated code,   â”‚
â”‚                                  BY AI-aware developers         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### What is "Slop"?

**Slop** (noun): Code generated by AI that works but wasn't written with security in mind. It's the Rails scaffold that ships to production. It's the ChatGPT snippet pasted without review. It's beautiful, functional chaos.

**Slop Security** doesn't judge your slop. It **protects** it.

---

## ğŸ¤– AI-First Design

Slop Security is optimized for LLM integration from the ground up. This means:

### 1. Predictable API Surface

Every SDK follows the exact same pattern:

```javascript
// Same pattern across ALL languages
slop.secure(yourApp)     // Wrap your app
slop.sandbox(yourCode)   // Sandbox untrusted code
slop.check(yourInput)    // Validate any input
```

### 2. LLM-Parseable Configuration

The `slop.json` schema is designed to be:
- **Deterministic** â€“ Same input always produces same output
- **Self-documenting** â€“ Every field has inline descriptions
- **AI-editable** â€“ LLMs can modify settings with confidence

### 3. Inline Documentation for Context Windows

All functions include JSDoc/docstrings optimized for AI context:

```javascript
/**
 * @slop Automatically applies OWASP A03 (Injection) protection
 * @param {string} query - Raw SQL query (will be parameterized)
 * @param {Object} params - Query parameters (auto-escaped)
 * @returns {Promise<Result>} Safe query result
 * @ai-hint Always use this instead of raw query execution
 */
slop.query(query, params)
```

### 4. AI Integration Hooks

```javascript
// For AI agents that generate code at runtime
slop.onCodeGeneration((code) => {
  return slop.sandbox(code, { 
    timeout: 5000,
    permissions: ['network', 'filesystem:read']
  })
})
```

---

## ğŸ” OWASP Core Integration

Slop Security provides **automatic, default-on protection** against the OWASP Top 10. No configuration required.

### OWASP Top 10 â†’ Slop Protection Matrix

| OWASP ID | Vulnerability | Slop Protection | Auto-Enabled |
|----------|---------------|-----------------|--------------|
| **A01:2021** | Broken Access Control | `AccessGuard` middleware | âœ… |
| **A02:2021** | Cryptographic Failures | `CryptoShield` wrapper | âœ… |
| **A03:2021** | Injection | `QuerySanitizer` engine | âœ… |
| **A04:2021** | Insecure Design | `DesignValidator` linter | âœ… |
| **A05:2021** | Security Misconfiguration | `ConfigHardener` defaults | âœ… |
| **A06:2021** | Vulnerable Components | `DependencyScanner` | âœ… |
| **A07:2021** | Auth Failures | `AuthGuard` middleware | âœ… |
| **A08:2021** | Software/Data Integrity | `IntegrityChecker` | âœ… |
| **A09:2021** | Logging Failures | `SecureLogger` | âœ… |
| **A10:2021** | SSRF | `RequestValidator` | âœ… |

---

### Detailed Protection Mechanisms

#### A01: Broken Access Control â†’ `AccessGuard`

```javascript
// Slop automatically enforces RBAC on all routes
// No explicit configuration needed

app.get('/admin/users', (req, res) => {
  // ğŸ›¡ï¸ Slop intercepts and validates:
  // - JWT/Session authenticity
  // - Role-based permissions
  // - Resource ownership
  // - Rate limiting per user
  res.json(users)
})
```

**Under the hood:**
- Automatic JWT validation with configurable algorithms
- Session fixation prevention
- Horizontal privilege escalation detection
- Automatic audit logging of access attempts

#### A02: Cryptographic Failures â†’ `CryptoShield`

```javascript
// Slop patches weak crypto automatically

// âŒ Before Slop (detected and fixed)
const hash = md5(password)  // Weak!

// âœ… After Slop (auto-upgraded)
const hash = slop.hash(password)  // Argon2id by default
```

**Automatic Protections:**
- Detects and warns on weak algorithms (MD5, SHA1, DES)
- Auto-upgrades to secure defaults (AES-256-GCM, Argon2id)
- Prevents hardcoded secrets in source code
- Enforces TLS 1.3 for all network operations

#### A03: Injection â†’ `QuerySanitizer`

```javascript
// The most common slop mistake: string concatenation
// Slop fixes it automatically

// âŒ Dangerous slop
const query = `SELECT * FROM users WHERE id = ${userId}`

// âœ… Slop-protected (auto-parameterized)
const result = slop.query`SELECT * FROM users WHERE id = ${userId}`
```

**Protection Scope:**
- SQL Injection (parameterization + encoding)
- NoSQL Injection (operator filtering)
- Command Injection (shell escaping)
- LDAP Injection (DN escaping)
- XPath Injection (expression sanitization)
- Template Injection (sandbox evaluation)

#### A04: Insecure Design â†’ `DesignValidator`

```javascript
// At build time, Slop analyzes code patterns

// âš ï¸ Warning: Rate limiting not detected on authentication endpoints
// âš ï¸ Warning: Missing CSRF protection on state-changing routes
// âš ï¸ Warning: File upload without size limits detected
```

**Design Checks:**
- Authentication rate limiting requirements
- Multi-factor authentication suggestions
- Business logic flaw patterns
- Missing security controls

#### A05: Security Misconfiguration â†’ `ConfigHardener`

```javascript
slop.secure(app)  // Single line enables:

// âœ… Secure headers (HSTS, CSP, X-Frame-Options)
// âœ… Cookie security (HttpOnly, Secure, SameSite=Strict)
// âœ… Error handling (no stack traces in production)
// âœ… CORS restrictions (origin allowlist)
// âœ… Debug mode disabled
// âœ… Default credentials detection
```

#### A06: Vulnerable Components â†’ `DependencyScanner`

```javascript
// Automatic on npm install / pip install / etc.

$ npm install some-package

ğŸ›¡ï¸ Slop Security Scan
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  CRITICAL: lodash@4.17.20 â†’ CVE-2021-23337
   Auto-patching to lodash@4.17.21 âœ…
   
âœ… Scan complete: 1 vulnerability patched
```

#### A07: Authentication Failures â†’ `AuthGuard`

```javascript
// Slop auto-hardens authentication

slop.auth({
  // Defaults (zero-config)
  bruteForceProtection: true,      // 5 attempts, 15min lockout
  passwordPolicy: 'strong',         // NIST 800-63B compliant
  sessionManagement: 'secure',      // Rotation on privilege change
  mfaRecommendation: true,         // Prompts to enable MFA
  credentialStuffingProtection: true
})
```

#### A08: Software & Data Integrity â†’ `IntegrityChecker`

```javascript
// Automatic subresource integrity for CDN assets
// Automatic signature verification for updates

slop.loadScript('https://cdn.example.com/lib.js')
// Automatically adds SRI hash
// <script src="..." integrity="sha384-oqVuA..." crossorigin="anonymous">
```

#### A09: Security Logging Failures â†’ `SecureLogger`

```javascript
// Automatic security event logging

slop.logger.security({
  events: ['auth', 'access', 'injection-attempt', 'rate-limit'],
  format: 'json',
  destination: 'stdout',  // Or file, SIEM, etc.
  pii: 'redact'           // Automatic PII redaction
})

// Output:
// {"timestamp":"2024-01-15T10:30:00Z","event":"injection-attempt",
//  "ip":"[REDACTED]","payload":"[SANITIZED]","blocked":true}
```

#### A10: SSRF â†’ `RequestValidator`

```javascript
// All outbound requests are validated

// âŒ Blocked: Internal network access attempt
fetch(userProvidedUrl)  // If URL points to 169.254.169.254, 10.x.x.x, etc.

// âœ… Slop validates:
// - No internal IP ranges (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)
// - No cloud metadata endpoints
// - No localhost/loopback
// - DNS rebinding protection
```

---

### ğŸ”§ Patching Common Slop Mistakes

Slop Security includes auto-patching for the most common AI-generated code mistakes:

| Mistake | Detection | Auto-Patch |
|---------|-----------|------------|
| Hardcoded API keys | Regex + entropy analysis | Move to env vars + warning |
| `eval()` with user input | AST analysis | Sandbox wrapper |
| Open redirects | URL parsing | Allowlist validation |
| Missing rate limiting | Route analysis | Auto-apply limits |
| Weak random generation | `Math.random()` detection | Upgrade to `crypto` |
| Debug endpoints in prod | Route name patterns | Auto-disable |
| Unvalidated file uploads | Multer/formidable detection | Size + type limits |
| Missing auth on routes | Middleware analysis | Auth requirement |
| Insecure deserialization | `pickle`/`JSON.parse` patterns | Safe deserializer |
| Exposed error messages | Error handler analysis | Generic responses |

---

## âš™ï¸ The Universal Engine

### Architecture Overview

Slop Security uses a **core security engine** written in **Rust**, compiled to **WebAssembly (WASM)** for universal cross-platform execution.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SLOP UNIVERSAL ENGINE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    RUST CORE ENGINE                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Parser  â”‚ â”‚ Sanitizerâ”‚ â”‚ Crypto  â”‚ â”‚ Policy Engine   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚       â”‚           â”‚           â”‚              â”‚              â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                           â”‚                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    WASM COMPILATION TARGET                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                      â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚          â–¼                   â–¼                   â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Node.js    â”‚   â”‚    Python    â”‚   â”‚     Go       â”‚           â”‚
â”‚  â”‚  (WASM RT)   â”‚   â”‚  (wasmtime)  â”‚   â”‚  (wazero)    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚                   â”‚                   â”‚                 â”‚
â”‚          â–¼                   â–¼                   â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚    Ruby      â”‚   â”‚     PHP      â”‚   â”‚    Rust      â”‚           â”‚
â”‚  â”‚ (wasmer-rb)  â”‚   â”‚  (wasmer-php)â”‚   â”‚   (native)   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Why Rust + WASM?

1. **Memory Safety** â€“ No buffer overflows in the security layer itself
2. **Performance** â€“ Near-native speed across all platforms
3. **Consistency** â€“ Identical behavior regardless of host language
4. **Auditability** â€“ Single codebase to audit for security
5. **Portability** â€“ Runs everywhere WASM runs (browsers, servers, edge)

### Core Engine Modules

```rust
// slop-core/src/lib.rs

pub mod sanitizer {
    /// SQL injection prevention with full OWASP compliance
    pub fn sanitize_sql(input: &str, dialect: SqlDialect) -> SafeQuery;
    
    /// XSS prevention with context-aware encoding
    pub fn sanitize_html(input: &str, context: HtmlContext) -> SafeHtml;
    
    /// Command injection prevention
    pub fn sanitize_shell(input: &str) -> SafeCommand;
}

pub mod crypto {
    /// Password hashing with Argon2id
    pub fn hash_password(password: &str) -> PasswordHash;
    
    /// Secure random generation
    pub fn random_bytes(length: usize) -> Vec<u8>;
    
    /// Encryption with AES-256-GCM
    pub fn encrypt(plaintext: &[u8], key: &Key) -> Ciphertext;
}

pub mod validator {
    /// SSRF prevention
    pub fn validate_url(url: &str, policy: &SsrfPolicy) -> UrlValidation;
    
    /// Input validation with schema
    pub fn validate_input(input: &Value, schema: &Schema) -> ValidationResult;
}

pub mod policy {
    /// Access control evaluation
    pub fn evaluate_access(subject: &Subject, resource: &Resource, action: &Action) -> Decision;
}
```

### Cross-Language Consistency

Every language SDK wraps the same WASM core, ensuring:

| Feature | Node.js | Python | Go | Ruby | PHP |
|---------|---------|--------|-----|------|-----|
| SQL Sanitization | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical |
| XSS Filtering | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical |
| Crypto Primitives | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical |
| Policy Evaluation | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical | âœ… Identical |
| Performance | ~1ms overhead | ~1ms overhead | ~1ms overhead | ~1ms overhead | ~1ms overhead |

---

## ğŸ“‹ The Slop Manifest (slop.json)

The `slop.json` file is the configuration schema that controls Slop Security behavior. It's designed to be:
- AI-editable with confidence
- Self-documenting
- Backwards compatible

### Schema Definition

```json
{
  "$schema": "https://slopsecurity.io/schema/v1.json",
  "version": "1.0.0",
  
  "project": {
    "name": "my-vibe-app",
    "environment": "production",
    "framework": "auto-detect"
  },

  "owasp": {
    "a01_access_control": {
      "enabled": true,
      "rbac": true,
      "audit_logging": true,
      "rate_limiting": {
        "enabled": true,
        "requests_per_minute": 100
      }
    },
    
    "a02_cryptographic_failures": {
      "enabled": true,
      "minimum_algorithm": "aes-256-gcm",
      "password_hashing": "argon2id",
      "enforce_tls": true,
      "detect_hardcoded_secrets": true
    },
    
    "a03_injection": {
      "enabled": true,
      "sqli_protection": true,
      "xss_filter": true,
      "command_injection": true,
      "nosql_injection": true,
      "template_injection": true
    },
    
    "a04_insecure_design": {
      "enabled": true,
      "rate_limit_auth": true,
      "require_mfa_prompt": false,
      "business_logic_checks": true
    },
    
    "a05_security_misconfiguration": {
      "enabled": true,
      "secure_headers": true,
      "disable_debug": true,
      "cookie_security": true,
      "cors_policy": "strict"
    },
    
    "a06_vulnerable_components": {
      "enabled": true,
      "auto_patch": true,
      "severity_threshold": "medium",
      "block_critical": true
    },
    
    "a07_auth_failures": {
      "enabled": true,
      "brute_force_protection": {
        "enabled": true,
        "max_attempts": 5,
        "lockout_minutes": 15
      },
      "password_policy": "nist-800-63b",
      "session_security": "strict"
    },
    
    "a08_integrity_failures": {
      "enabled": true,
      "sri_enforcement": true,
      "update_verification": true
    },
    
    "a09_logging_failures": {
      "enabled": true,
      "security_events": ["auth", "access", "injection", "rate-limit"],
      "pii_redaction": true,
      "format": "json"
    },
    
    "a10_ssrf": {
      "enabled": true,
      "block_internal": true,
      "block_metadata": true,
      "dns_rebinding_protection": true,
      "allowlist": []
    }
  },

  "patching": {
    "auto_patch": true,
    "hardcoded_secrets": "warn-and-move",
    "weak_crypto": "upgrade",
    "eval_usage": "sandbox",
    "open_redirects": "block"
  },

  "sandbox": {
    "enabled": true,
    "timeout_ms": 5000,
    "memory_limit_mb": 128,
    "allowed_permissions": ["network", "filesystem:read"]
  },

  "reporting": {
    "realtime_alerts": true,
    "weekly_digest": true,
    "siem_integration": null,
    "webhook_url": null
  }
}
```

### AI-Editable Examples

An AI assistant can confidently modify this config:

```javascript
// AI prompt: "Disable rate limiting for the API"
// AI response: I'll update your slop.json

const config = {
  "owasp": {
    "a01_access_control": {
      "rate_limiting": {
        "enabled": false  // â† AI changes this
      }
    }
  }
}
```

---

## ğŸŒ Language SDK Blueprints

### One-Line Integration Examples

#### JavaScript / Node.js

```javascript
// Install: npm install @slop/security

// Express.js
const express = require('express')
const slop = require('@slop/security')

const app = express()
slop.secure(app)  // ğŸ›¡ï¸ One line. That's it.

app.listen(3000)
```

```javascript
// Next.js (middleware.ts)
import { slopMiddleware } from '@slop/security/next'
export default slopMiddleware()
```

```javascript
// Fastify
const fastify = require('fastify')()
const slop = require('@slop/security')

fastify.register(slop.fastify())
```

#### Python

```python
# Install: pip install slop-security

# Flask
from flask import Flask
from slop import secure

app = Flask(__name__)
secure(app)  # ğŸ›¡ï¸ One line. That's it.
```

```python
# FastAPI
from fastapi import FastAPI
from slop import SlopMiddleware

app = FastAPI()
app.add_middleware(SlopMiddleware)  # ğŸ›¡ï¸ One line
```

```python
# Django (settings.py)
MIDDLEWARE = [
    'slop.django.SlopSecurityMiddleware',  # ğŸ›¡ï¸ Add to top
    # ... other middleware
]
```

#### Go

```go
// Install: go get github.com/slop-security/slop-go

package main

import (
    "net/http"
    "github.com/slop-security/slop-go"
)

func main() {
    handler := http.HandlerFunc(myHandler)
    secured := slop.Secure(handler)  // ğŸ›¡ï¸ One line
    http.ListenAndServe(":8080", secured)
}
```

```go
// Gin
import "github.com/slop-security/slop-go/gin"

r := gin.Default()
r.Use(slop.Middleware())  // ğŸ›¡ï¸ One line
```

#### Ruby

```ruby
# Install: gem install slop-security

# Rails (config/application.rb)
require 'slop'

module MyApp
  class Application < Rails::Application
    config.middleware.use Slop::Security  # ğŸ›¡ï¸ One line
  end
end
```

```ruby
# Sinatra
require 'sinatra'
require 'slop'

use Slop::Security  # ğŸ›¡ï¸ One line

get '/' do
  'Hello, secured world!'
end
```

#### PHP

```php
<?php
// Install: composer require slop/security

// Laravel (bootstrap/app.php)
use Slop\Security\SlopMiddleware;

$app->middleware([
    SlopMiddleware::class,  // ğŸ›¡ï¸ One line
]);
```

```php
// Vanilla PHP
require 'vendor/autoload.php';
Slop\Security::init();  // ğŸ›¡ï¸ One line

// Your code here...
```

---

### The `slop.secure()` Wrapper

For AI-generated code that needs sandboxing:

```javascript
// JavaScript
const result = await slop.secure(async () => {
  // Any AI-generated code here is:
  // âœ… Sandboxed (can't access filesystem unless allowed)
  // âœ… Time-limited (5s default timeout)
  // âœ… Memory-limited (128MB default)
  // âœ… Network-restricted (can't hit internal IPs)
  
  const response = await fetch(userProvidedUrl)
  return response.json()
}, {
  permissions: ['network'],
  timeout: 3000
})
```

```python
# Python
from slop import secure

@secure(permissions=['network'], timeout=3000)
async def fetch_data(url: str):
    # Sandboxed execution
    response = await httpx.get(url)
    return response.json()
```

```go
// Go
result, err := slop.Secure(func() (interface{}, error) {
    // Sandboxed execution
    return fetchData(url)
}, slop.WithPermissions("network"), slop.WithTimeout(3*time.Second))
```

---

## ğŸ” The "Vibe-Check" CLI

Vibe-Check is a command-line tool that scans AI-generated code for OWASP violations and auto-patches them.

### Installation

```bash
# npm
npm install -g @slop/vibe-check

# Homebrew
brew install slop-security/tap/vibe-check

# Binary download
curl -fsSL https://get.slopsecurity.io | sh
```

### Usage

```bash
# Scan current directory
vibe-check .

# Scan with auto-patching
vibe-check . --fix

# Scan specific files
vibe-check src/**/*.js

# CI/CD mode (exit code on failures)
vibe-check . --ci

# Generate report
vibe-check . --report html > security-report.html
```

### Example Output

```
$ vibe-check .

ğŸ” Vibe-Check Security Scanner v1.0.0
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Scanning: 47 files (JavaScript, TypeScript)

CRITICAL â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš¨ A03:Injection - SQL Injection vulnerability
   src/db/users.js:24
   
   const query = `SELECT * FROM users WHERE id = ${userId}`
                                                    ^^^^^^^^
   
   âš¡ Fix available: Use parameterized query
   Run: vibe-check . --fix

HIGH â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  A02:CryptoFailures - Hardcoded API key detected
   src/config.js:8
   
   const API_KEY = "sk-live-abc123def456..."
                   ^^^^^^^^^^^^^^^^^^^^^^^^
   
   âš¡ Fix available: Move to environment variable
   Run: vibe-check . --fix

MEDIUM â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  A05:Misconfiguration - Debug mode enabled in production
   src/app.js:12
   
   app.set('debug', true)
                    ^^^^
   
   âš¡ Fix available: Disable in production
   Run: vibe-check . --fix

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUMMARY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Critical: 1  â”‚  High: 1  â”‚  Medium: 1  â”‚  Low: 0
Auto-fixable: 3/3 âœ…

Run 'vibe-check . --fix' to auto-patch all issues
```

### Auto-Patch Example

```bash
$ vibe-check . --fix

ğŸ”§ Vibe-Check Auto-Patcher
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Patching src/db/users.js:24
  - const query = `SELECT * FROM users WHERE id = ${userId}`
  + const [rows] = await db.query('SELECT * FROM users WHERE id = ?', [userId])
  âœ… Patched

Patching src/config.js:8
  - const API_KEY = "sk-live-abc123def456..."
  + const API_KEY = process.env.API_KEY
  ğŸ“ Added to .env.example: API_KEY=
  âš ï¸  Remember to set API_KEY in your environment!
  âœ… Patched

Patching src/app.js:12
  - app.set('debug', true)
  + app.set('debug', process.env.NODE_ENV !== 'production')
  âœ… Patched

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… All 3 issues patched successfully!
ğŸ’¾ Changes written to 3 files
```

### CI/CD Integration

```yaml
# GitHub Actions
name: Security Check
on: [push, pull_request]

jobs:
  vibe-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: slop-security/vibe-check-action@v1
        with:
          fail-on: critical,high
          auto-fix: false
```

```yaml
# GitLab CI
security-scan:
  image: slopsecurity/vibe-check:latest
  script:
    - vibe-check . --ci --fail-on critical,high
  artifacts:
    reports:
      security: vibe-check-report.json
```

---

## ğŸ“ System Instructions Snippet

Copy and paste this into your AI assistant's custom instructions to ensure Slop Security is always used:

### For General AI Coding Assistants

```
## Security Requirements for Code Generation

When generating code for web applications, APIs, or any server-side functionality, always include Slop Security integration:

1. **Initialization**: Always start server applications with:
   - JavaScript: `const slop = require('@slop/security'); slop.secure(app);`
   - Python: `from slop import secure; secure(app)`
   - Go: `import slop; secured := slop.Secure(handler)`
   - PHP: `Slop\Security::init();`

2. **Database Queries**: Never use string concatenation. Always use:
   - `slop.query\`SELECT * FROM users WHERE id = ${userId}\``
   - Or parameterized queries with your ORM

3. **User Input**: Always validate with:
   - `slop.validate(input, schema)`

4. **Sensitive Operations**: Wrap in sandbox:
   - `slop.secure(() => { /* code */ }, { permissions: ['network'] })`

5. **Secrets**: Never hardcode. Always use:
   - `process.env.SECRET_NAME` or equivalent

If you cannot use Slop Security, explicitly warn the user about OWASP risks in the generated code.
```

### For Cursor / Copilot / Aider

```
# .slop-instructions

All generated code must:
1. Import and initialize @slop/security at the entry point
2. Use slop.query`` for all database operations
3. Validate all user input with slop.validate()
4. Never include hardcoded secrets
5. Wrap untrusted code execution in slop.secure()

When generating security-sensitive code (auth, payments, file uploads),
add a comment: // ğŸ›¡ï¸ SLOP-PROTECTED: [protection type]
```

### For ChatGPT Custom GPT

```
You are a security-conscious coding assistant. All code you generate follows these rules:

1. Every web application includes Slop Security initialization
2. Every database query uses parameterized queries or slop.query
3. Every user input is validated before use
4. Secrets are always read from environment variables
5. Untrusted code execution is sandboxed

When generating code, include this header comment:
// ğŸ›¡ï¸ This code is protected by Slop Security
// ğŸ” OWASP Top 10 mitigations are active

If security cannot be guaranteed, output a WARNING block explaining the risks.
```

---

## ğŸ“Š Architecture Diagrams

### Slop-to-OWASP Mapping

```mermaid
flowchart TB
    subgraph Input["ğŸŒ User Input"]
        A[HTTP Request]
        B[User Data]
        C[File Upload]
    end

    subgraph SlopEngine["ğŸ›¡ï¸ SLOP SECURITY ENGINE"]
        direction TB
        
        subgraph L1["Layer 1: Request Validation"]
            D[Rate Limiter]
            E[CORS Validator]
            F[Header Security]
        end
        
        subgraph L2["Layer 2: Input Sanitization"]
            G[SQL Sanitizer]
            H[XSS Filter]
            I[Shell Escaper]
        end
        
        subgraph L3["Layer 3: Auth & Access"]
            J[JWT Validator]
            K[RBAC Engine]
            L[Session Manager]
        end
        
        subgraph L4["Layer 4: Crypto"]
            M[Encryption]
            N[Hashing]
            O[Key Management]
        end
    end

    subgraph OWASP["ğŸ“‹ OWASP TOP 10"]
        P["A01: Access Control"]
        Q["A02: Crypto Failures"]
        R["A03: Injection"]
        S["A05: Misconfiguration"]
        T["A07: Auth Failures"]
        U["A10: SSRF"]
    end

    subgraph App["ğŸš€ Application"]
        V[Protected Code]
        W[Safe Database Queries]
        X[Secure Responses]
    end

    A --> D
    B --> G
    C --> H
    
    D --> E --> F
    F --> G
    G --> H --> I
    I --> J
    J --> K --> L
    L --> M --> N --> O
    
    D -.->|Protects| P
    M -.->|Protects| Q
    G -.->|Protects| R
    F -.->|Protects| S
    J -.->|Protects| T
    D -.->|Protects| U
    
    O --> V
    V --> W --> X
```

### Request Lifecycle

```mermaid
sequenceDiagram
    participant User
    participant Slop as ğŸ›¡ï¸ Slop Security
    participant App as Application
    participant DB as Database

    User->>Slop: HTTP Request
    
    Note over Slop: Layer 1: Request Validation
    Slop->>Slop: Check Rate Limits
    Slop->>Slop: Validate Headers
    Slop->>Slop: Apply CORS Policy
    
    Note over Slop: Layer 2: Auth & Session
    Slop->>Slop: Validate JWT/Session
    Slop->>Slop: Check Permissions (RBAC)
    
    alt Unauthorized
        Slop-->>User: 401/403 Response
    end
    
    Note over Slop: Layer 3: Input Sanitization
    Slop->>Slop: Sanitize SQL Input
    Slop->>Slop: Filter XSS Patterns
    Slop->>Slop: Validate Against Schema
    
    alt Invalid Input
        Slop-->>User: 400 Bad Request
    end
    
    Slop->>App: Safe Request Object
    App->>Slop: Database Query
    
    Note over Slop: Query Protection
    Slop->>Slop: Parameterize Query
    Slop->>DB: Safe Query
    DB-->>Slop: Results
    Slop-->>App: Results
    
    App->>Slop: Response Data
    
    Note over Slop: Response Security
    Slop->>Slop: Add Security Headers
    Slop->>Slop: Sanitize Output
    Slop->>Slop: Log Security Event
    
    Slop-->>User: Secure Response
```

### WASM Engine Architecture

```mermaid
flowchart LR
    subgraph RustCore["ğŸ¦€ Rust Core"]
        A[Sanitizer] 
        B[Crypto]
        C[Validator]
        D[Policy Engine]
    end
    
    RustCore --> WASM["ğŸ“¦ WASM Binary\n(~500KB gzipped)"]
    
    WASM --> Node["Node.js SDK"]
    WASM --> Python["Python SDK"]
    WASM --> Go["Go SDK"]
    WASM --> Ruby["Ruby SDK"]
    WASM --> PHP["PHP SDK"]
    
    Node --> Express["Express/Fastify"]
    Python --> Flask["Flask/FastAPI/Django"]
    Go --> NetHTTP["net/http / Gin"]
    Ruby --> Rails["Rails/Sinatra"]
    PHP --> Laravel["Laravel/Symfony"]
```

---

## ğŸ¤ Contributing

Slop Security is open source and welcomes contributions!

### Getting Started

```bash
# Clone the repository
git clone https://github.com/slop-security/slop-security.git
cd slop-security

# Install Rust toolchain
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Install WASM target
rustup target add wasm32-unknown-unknown

# Build the core engine
cd slop-core
cargo build --release --target wasm32-unknown-unknown

# Run tests
cargo test
```

### Project Structure

```
slop-security/
â”œâ”€â”€ slop-core/           # Rust core engine
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ sanitizer/   # Input sanitization
â”‚   â”‚   â”œâ”€â”€ crypto/      # Cryptographic operations
â”‚   â”‚   â”œâ”€â”€ validator/   # Schema validation
â”‚   â”‚   â””â”€â”€ policy/      # Access control
â”‚   â””â”€â”€ Cargo.toml
â”œâ”€â”€ sdks/
â”‚   â”œâ”€â”€ node/            # Node.js SDK
â”‚   â”œâ”€â”€ python/          # Python SDK
â”‚   â”œâ”€â”€ go/              # Go SDK
â”‚   â”œâ”€â”€ ruby/            # Ruby SDK
â”‚   â””â”€â”€ php/             # PHP SDK
â”œâ”€â”€ vibe-check/          # CLI tool
â”œâ”€â”€ docs/                # Documentation
â””â”€â”€ slop.schema.json     # Configuration schema
```

### Contribution Guidelines

1. **Security Issues**: Report privately to security@slopsecurity.io
2. **Bug Reports**: Open an issue with reproduction steps
3. **Feature Requests**: Open a discussion first
4. **Pull Requests**: 
   - Include tests
   - Update documentation
   - Follow existing code style
   - Sign the CLA

---

## ğŸ“œ License

Slop Security is released under the **MIT License**.

```
MIT License

Copyright (c) 2024 Slop Security Contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

<div align="center">

### ğŸ›¡ï¸ Built for Vibecoders, by Vibecoders

**One line to secure, zero lines to worry.**

[Get Started](https://slopsecurity.io/docs) â€¢ [GitHub](https://github.com/slop-security) â€¢ [Discord](https://discord.gg/slopsecurity)

</div>
